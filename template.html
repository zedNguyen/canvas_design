<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>저장위치 관리</title>

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="robots" content="noindex,nofollow" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Global site tag (gtag.js) - Google Analytics PROD만 동작 -->

    <link href="./저장위치 관리_files/bootstrap.min.css" rel="stylesheet" />
    <link
      href="./저장위치 관리_files/perfect-scrollbar.min.css"
      rel="stylesheet"
    />

        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <link
      href="./저장위치 관리_files/jquery.bootstrap-touchspin.min.css"
      rel="stylesheet"
    />

    <link href="./저장위치 관리_files/style.css" rel="stylesheet" />
    <link href="./저장위치 관리_files/jquery-ui.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="./저장위치 관리_files/pinejs.css" />

    <link href="./저장위치 관리_files/ag-grid.min.css" rel="stylesheet" />
    <link
      href="./저장위치 관리_files/ag-theme-balham.min.css"
      rel="stylesheet"
    />
    <link href="./저장위치 관리_files/aggrid.css" rel="stylesheet" />

    <link href="./저장위치 관리_files/toastr.css" rel="stylesheet" />

    <link href="./저장위치 관리_files/blue.css" id="theme" rel="stylesheet" />

    <link href="./저장위치 관리_files/custom.css" rel="stylesheet" />

    <script src="./저장위치 관리_files/jquery.min.js.download"></script>

    <script src="./저장위치 관리_files/popper.min.js.download"></script>
    <script src="./저장위치 관리_files/bootstrap.min.js.download"></script>

    <script src="./저장위치 관리_files/perfect-scrollbar.jquery.min.js.download"></script>

    <script src="./저장위치 관리_files/waves.js.download"></script>

    <script src="./저장위치 관리_files/sidebarmenu.js.download"></script>
    <!-- <script th:src="@{/plugins/pinejs/js/adminpro.js}"></script> -->

    <script src="./저장위치 관리_files/adminpro.js.download"></script>

    <script src="./저장위치 관리_files/jquery.toast.js.download"></script>

    <script src="./저장위치 관리_files/jquery.serializeObject.min.js.download"></script>

    <script src="./저장위치 관리_files/jquery.validate.min.js.download"></script>
    <script src="./저장위치 관리_files/messages_ko.js.download"></script>

    <script src="./저장위치 관리_files/jquery-ui.min.js.download"></script>
    <script src="./저장위치 관리_files/numeral.min.js.download"></script>
    <script src="./저장위치 관리_files/lodash.4.17.15.min.js.download"></script>
    <script src="./저장위치 관리_files/moment.js.download"></script>

    <script src="./저장위치 관리_files/jquery.collapse.js.download"></script>

    <script src="./저장위치 관리_files/jquery.bootstrap-touchspin.min.js.download"></script>
    <!-- bootstrap submodal -->
    <script src="./저장위치 관리_files/bs.sm.js.download"></script>

    <script src="./저장위치 관리_files/xlsx.full.min.js.download"></script>
    <script src="./저장위치 관리_files/fileSaver.min.js.download"></script>
    <script src="./저장위치 관리_files/toastr.min.js.download"></script>

    <script src="./저장위치 관리_files/jquery.mask.js.download"></script>

    <script src="./저장위치 관리_files/ag-grid-enterprise.min.noStyle.js.download"></script>
    <script>
      agGrid.LicenseManager.setLicenseKey(
        "CompanyName=JSIT,LicensedGroup=HANSOL PNS IT-SERVICE,LicenseType=MultipleApplications,LicensedConcurrentDeveloperCount=3,LicensedProductionInstancesCount=2,AssetReference=AG-008218,ExpiryDate=21_May_2021_[v2]_MTYyMTU1MTYwMDAwMA==fb098f15da774457685846b99c4a3a7e"
      );
    </script>
    <script src="./저장위치 관리_files/ag_base.js.download"></script>
    <script src="./저장위치 관리_files/ag_locale_ko.js.download"></script>
    <script src="./저장위치 관리_files/ag_renderer.js.download"></script>
    <script src="./저장위치 관리_files/ag_formatter.js.download"></script>
    <script src="./저장위치 관리_files/ag_editor.js.download"></script>
    <script src="./저장위치 관리_files/ag_excel.js.download"></script>

    <!-- CK Editor -->
    <!-- ============================================================== -->
    <script src="./저장위치 관리_files/ckeditor.js.download"></script>
    <style>
      .cke {
        visibility: hidden;
      }
    </style>

    <script src="./저장위치 관리_files/pine.js.download"></script>
    <script src="./저장위치 관리_files/global-val.js.download"></script>
    <script src="./저장위치 관리_files/core.js.download"></script>
    <script src="./저장위치 관리_files/file.js.download"></script>
    <script src="./저장위치 관리_files/auth.js.download"></script>
    <script src="./저장위치 관리_files/editor.js.download"></script>
    <script src="./저장위치 관리_files/aggridHelper.js.download"></script>

    <!-- ============================================================== -->

    <script src="./저장위치 관리_files/doc_ready.js.download"></script>
  </head>

  <body class="fix-header card-no-border main">
    <div class="preloader" style="display: none">
      <div class="loader">
        <div class="loader__figure"></div>
        <p class="loader__label">Harmony</p>
      </div>
    </div>

    <div id="main-wrapper">
      <header class="topbar">
        <nav class="navbar top-navbar navbar-expand-md navbar-light">
          <div class="navbar-header">
            <a class="navbar-brand">
              <b>
                <img
                  src="./저장위치 관리_files/logo-icon.png"
                  alt="homepage"
                  class="dark-logo"
                />

                <img
                  src="./저장위치 관리_files/logo-light-icon.png"
                  alt="homepage"
                  class="light-logo"
                />
              </b>

              <span>
                <img
                  src="./저장위치 관리_files/logo-text.png"
                  alt="homepage"
                  class="dark-logo" />

                <img
                  src="./저장위치 관리_files/logo-light-text.png"
                  class="light-logo"
                  alt="homepage"
              /></span>
            </a>
          </div>

          <div class="navbar-collapse">
            <ul class="navbar-nav mr-auto">
              <li class="nav-item">
                <a
                  class="nav-link nav-toggler hidden-md-up waves-effect waves-dark"
                  href="javascript:void(0)"
                  ><i class="ti-menu"></i
                ></a>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link sidebartoggler hidden-sm-down waves-effect waves-dark"
                  href="javascript:void(0)"
                  ><i class="fa-solid fa-bars"></i></a>
              </li>
            </ul>

            <ul class="navbar-nav my-lg-0">
              <li class="nav-item">
                <a class="nav-link" href="javascript:void(0)">
                  <span style="font-weight: bold; font-size: 18px"
                    >dev서버</span
                  >
                </a>
              </li>

              <li class="nav-item hidden-xs-down search-box">
                <a
                  class="nav-link hidden-sm-down waves-effect waves-dark"
                  href="javascript:void(0)"
                  title="메뉴 검색"
                  ><i class="ti-search"></i
                ></a>
                <form class="app-search" onsubmit="return false">
                  <input
                    type="text"
                    id="menu-search-txt"
                    class="form-control"
                    placeholder="메뉴 검색"
                  />
                  <a class="srh-btn"><i class="ti-close"></i></a>
                  <div id="menu-search" class="search-rslt"></div>
                </form>
              </li>

              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle waves-effect waves-dark"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  <span>시스템관리</span>
                </a>
                <div class="dropdown-menu dropdown-menu-right animated flipInY">
                  <ul class="dropdown-user">
                    <li>
                      <div class="dw-user-box">
                        <div class="u-text">
                          <h4>
                            <i class="fas fa-user"></i>&nbsp;
                            <span>시스템관리</span>
                          </h4>
                          <p class="text-muted"><span></span></p>
                        </div>
                      </div>
                    </li>
                    <li role="separator" class="divider"></li>
                    <li>
                      <a

                        ><i class="ti-settings"></i> 계정설정</a
                      >
                    </li>
                    <li role="separator" class="divider"></li>
                    <li>
                    <a 
                        ><i class="fa fa-power-off"></i> 로그아웃</a
                      >
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <aside class="left-sidebar">
        <div
          class="scroll-sidebar ps-container ps-theme-default"
          data-ps-id="6445c0c0-d75d-a3cd-4fab-49cc73438c65"
        >
          <nav class="sidebar-nav active">
            <ul id="sidebarnav" class="in">
              <li class="nav-small-cap">즐겨찾기 ★</li>
              <ul class="list-group" id="sidebarnav-favorite"></ul>
              <li class="nav-devider"></li>

              <li class="nav-small-cap">프로그램</li>

              <li>
                <a
                  class="has-arrow waves-effect waves-dark"
                  aria-expanded="false"
                >
                  <i class="mdi mdi-format-list-bulleted"></i>
                  <span class="hide-menu">Canvas</span>
                </a>

                <ul aria-expanded="false" class="collapse">
                  <li>
                    <a
                      class="has-arrow waves-effect waves-dark"
                      aria-expanded="false"
                      href="/learn/page1.html"
                      >생산지시서 관리</a
                    >
                  </li>
                  <li>
                    <a
                      class="has-arrow waves-effect waves-dark"

                      aria-expanded="false"
                      >사용자&amp;조직도</a
                    >

                    <a
                      class="has-arrow waves-effect waves-dark"
        
                      aria-expanded="false"
                      >메뉴&amp;프로그램</a
                    >
                  </li>
                </ul>
              </li>
            </ul>
          </nav>
          <div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 0px">
            <div
              class="ps-scrollbar-x"
              tabindex="0"
              style="left: 0px; width: 0px"
            ></div>
          </div>
          <div class="ps-scrollbar-y-rail" style="top: 0px; right: 3px">
            <div
              class="ps-scrollbar-y"
              tabindex="0"
              style="top: 0px; height: 0px"
            ></div>
          </div>
        </div>
      </aside>

      <div class="page-wrapper" style="min-height: 952px">
        <div class="container-fluid r-aside">
          <div class="row page-titles m-b-10">
            <div class="col-md-5 align-self-center">
              <!-- <h4 class="text-themecolor"><i class="fas fa-sticky-note pageIcon"></i><span id="pageTitles">HOME</span></h3> -->
              <!-- <h6 class="text-themecolor" id="pageTitleText">HOME</h5> -->
              <li id="pageTitleText">
                생산지시서 관리<i
                  class="fa-regular fa-star"
                  style="font-size: 16px !important; weight: bold !important; margin-left: 5px"
                  data-favo="N"
                ></i>
              </li>
            </div>
          </div>

          <div class="toolbar">
            <div class="toolbar-right">
              <button id="btn-reset" class="btn btn-outline-secondary btn-sm">
                초기화
              </button>
              <button
                id="btn-search"
                type="button"
                class="btn btn-inverse btn-sm"
              >
                조회
              </button>
              <button id="btn-save" type="button" class="btn btn-info btn-sm">
                저장
              </button>
            </div>
            <div class="after-floatright"></div>
          </div>

          <div class="card" data-collapse="">
            <div
              class="card-header field-header open"
              data-collapse-summary=""
              aria-expanded="true"
            >
              <a >
                <a
      
                  class="card-link"
                  aria-expanded="true"
                  aria-controls="cardBody"
                  >검색조건
                  <span class="expanded">
                    <p><b>▼</b></p>
                  </span>
                </a>
              </a>
            </div>
            <div
              id="cardBody"
              class="collapse show field-body"
              aria-hidden="false"
            >
              <div>

                <h1>alo</h1>
              </div>
            </div>
          </div>



          <!-- Table Here -->

          <!-- Tab Start-->

          <!-- Tab End -->
        </div>

        <footer class="footer text-center">© 2025 Harmony by HansolPNS</footer>
      </div>
    </div>

    <input type="hidden" id="spring_profile" value="dev" />
    <input type="hidden" id="loginUserId" value="marusys" />
    <input type="hidden" id="session_USER_ID" value="marusys" />
    <input type="hidden" id="session_USER_NM" value="시스템관리" />
    <input type="hidden" id="session_MANDT" value="100" />
    <input type="hidden" id="session_MANDT_NM" value="지류유통" />
    <input type="hidden" id="session_BUKRS" value="M200" />
    <input type="hidden" id="session_BUKRS_NM" value="PNS지류유통" />
    <input type="hidden" id="session_VKGRP" value="" />
    <input type="hidden" id="session_VKGRP_NM" value="" />
    <input type="hidden" id="session_MOBILE" value="" />
    <input type="hidden" id="session_EMAIL" value="" />
    <input type="hidden" id="session_KOSTL" value="" />
    <input type="hidden" id="session_ADMIN_YN" value="N" />
    <input type="hidden" id="session_LOGIN_DT" value="2025-07-15 19:30:24" />
    <input type="hidden" id="session_SMART_ID" value="" />
    <input type="hidden" id="session_SMART_PASSWORD" value="" />
    <input type="hidden" id="session_USER_IP" value="0:0:0:0:0:0:0:1" />
    <input type="hidden" id="session_SESSION_ID" value="" />
    <input type="hidden" id="session_FIRST_TOPMENU" value="" />
    <input type="hidden" id="session_MM" value="MM999" />
    <input type="hidden" id="session_SD" value="SD999" />
    <input type="hidden" id="session_CO" value="CO999" />
    <input type="hidden" id="session_FI" value="FI999" />
    <input type="hidden" id="session_CM" value="CM999" />
    <input type="hidden" id="session_IN_IP_YN" value="N" />
    <input type="hidden" id="session_UPPER_BU" value="" />
    <input type="hidden" id="session_UPPER_NAME" value="" />

    <input id="message" type="hidden" value="" />




    <script>
      $(document).ready(function () {



      });
    </script>



    <!-- 타임리프 사용을 위해서 th:inline="javascript" -->
    <script>
      let maingrid;
      let grpData = [
        {
          SORT_ORD: 0,
          CODE_CD: "CMR",
          CODE_NM: "\uCDA9\uBB34\uB85C\uCC3D\uACE0",
        },
        { SORT_ORD: 0, CODE_CD: "ETC", CODE_NM: "\uAE30\uD0C0" },
        { SORT_ORD: 0, CODE_CD: "HK", CODE_NM: "\uD55C\uAD6D\uC81C\uC9C0" },
        { SORT_ORD: 0, CODE_CD: "HW", CODE_NM: "\uD64D\uC6D0\uC81C\uC9C0" },
        {
          SORT_ORD: 0,
          CODE_CD: "LOGIS",
          CODE_NM: "\uB85C\uC9C0\uC2A4\uD2F1\uC2A4",
        },
        {
          SORT_ORD: 0,
          CODE_CD: "LOGIS_COVT",
          CODE_NM: "\uB85C\uC9C0\uC2A4\uD2F1\uC2A4(\uCEE8\uBC84\uD305)",
        },
        {
          SORT_ORD: 0,
          CODE_CD: "PAJU",
          CODE_NM: "\uD30C\uC8FC\uD1B5\uD569\uCC3D\uACE0",
        },
        {
          SORT_ORD: 0,
          CODE_CD: "PAJU_COVT",
          CODE_NM: "\uD30C\uC8FC\uCEE8\uBC84\uD305",
        },
      ];
      let grpDataList = ag_genComboList(grpData, "CODE_CD", "CODE_NM");

      /*
       *******************************************************
       * Form Validation
       *******************************************************
       */

      // detailForm validation
      $("#detailForm").validate({
        rules: {
          // 회사 필수 체크
          BUKRS: {
            required: true,
          },
          // 플랜트 필수 체크
          WERKS: {
            required: true,
          },
          // 저장위치 필수 체크
          LGORT: {
            required: true,
          },
        },
        messages: {
          // 에러 문구 수정이 필요한 경우 아래에 필드별 에러메시지를 정의한다
          BUKRS: {
            required: "회사를 입력하세요",
          },
          WERKS: {
            required: "플랜트를 입력하세요",
          },
          LGORT: {
            required: "저장위치를 입력하세요",
          },
        },
      });

      /* 조회 */
      function fn_search() {
        //alert('fn_search()');
        if (!$("#searchForm").valid()) return;

        let params_data = pine.form_Serializable("#searchForm");
        params_data["MANDT"] = $("#session_MANDT").val();

        maingrid.loadData({
          url: "/api/hplmm/sytm/sytm_020/SELECT_D1",
          params: params_data,
          /* complete callback */
          success: function () {
            // 1건이상 조회시 1Row 자동선택
            let rowcnt = maingrid.gridOptions.api.getDisplayedRowCount();
            if (rowcnt > 0) {
              maingrid.gridOptions.api.getRowNode(0).setSelected(true);
            } else {
            }
          },
        });
      }

      $(document).ready(function () {
        /*
         * Grid
         */
        // Ag-grid 칼럼 정의
        let gridOptions = {
          cud: true,
          bindFormId: "detailForm",
          defaultColDef: {
            resizable: true,
            editable: false,
          },
          columnDefs: [
            {
              headerName: "클라이언트",
              field: "PK_MANDT",
              width: 80,
              hide: true,
            },
            {
              headerName: "회사코드",
              field: "PK_BUKRS",
              width: 80,
              hide: true,
            },
            { headerName: "플랜트", field: "PK_WERKS", width: 80, hide: true },
            {
              headerName: "저장위치",
              field: "PK_LGORT",
              width: 80,
              hide: true,
            },
            { headerName: "클라이언트", field: "MANDT", width: 80, hide: true },
            {
              headerName: "회사코드",
              field: "BUKRS",
              width: 100,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "회사명",
              field: "BUKRS_NM",
              width: 200,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "플랜트",
              field: "WERKS",
              width: 150,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "플랜트명",
              field: "WERKS_NM",
              width: 200,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "저장위치",
              field: "LGORT",
              width: 150,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "저장위치명",
              field: "LGOBE",
              width: 250,
              cellStyle: { textAlign: "left" },
            },
            {
              headerName: "적정재고그룹",
              field: "PUMG_010_GRP",
              width: 120,
              cellStyle: { textAlign: "left" },
              cellRenderer: ag_comboRenderer(grpDataList),
              cellEditor: ag_comboEditor(grpData, { makeAllOption: true }),
              editable: true,
            },
            { headerName: "사용여부", field: "USE_YN", width: 80, hide: true },
            {
              headerName: "이동자동출고",
              field: "MO_AUTO_CH",
              width: 120,
              checkValue: "Y",
              uncheckValue: "N",
              cellRenderer: AG_EDITOR.CHECKBOX,
              isDisabled: function () {
                return false;
              },
              editable: true,
            },
            {
              headerName: "자사창고여부",
              field: "OWN_LGORT_YN",
              width: 120,
              checkValue: "Y",
              uncheckValue: "N",
              cellRenderer: AG_EDITOR.CHECKBOX,
              isDisabled: function () {
                return false;
              },
              editable: true,
            },
            {
              headerName: "계약종료여부",
              field: "EXPIRED_YN",
              width: 120,
              checkValue: "Y",
              uncheckValue: "N",
              cellRenderer: AG_EDITOR.CHECKBOX,
              isDisabled: function () {
                return false;
              },
              editable: true,
            },
            { headerName: "생성일", field: "ERDAT", width: 80, hide: true },
            { headerName: "생성자", field: "ERNAM", width: 80, hide: true },
            { headerName: "변경일", field: "AEDAT", width: 80, hide: true },
            { headerName: "변경자", field: "AENAM", width: 80, hide: true },
          ],
          rowSelection: "single",
          onSelectionChanged: function () {
            let selectedRow = maingrid.gridOptions.api.getSelectedRows();
            maingrid.bindToForm(selectedRow[0]); // grid api 호출
          },
        };



        //엑셀 버튼


        // grid load
        maingrid = new Grid($(".grid"), gridOptions);

        /*
         * Add EVENT
         */
        $("#btn-reset").on("click", function () {
          fn_reset();
        });

        $("#btn-search").on("click", function () {
          // 변경여부 체크
          if (maingrid.isCUDChanged()) {
            if (
              !confirm(
                "\n변경된 자료가 있습니다. \n 조회시 변경된 자료는 저장되지 않습니다. \n 계속 진행하시겠습니까?"
              )
            )
              return;
          }

          fn_search();
        });

        // 저장
        $("#btn-save").on("click", function () {
          // 변경여부 체크
          if (!maingrid.isCUDChanged()) {
            alert("변경된 자료가 없습니다.");
            return;
          }

          maingrid.gridOptions.api.stopEditing();
          let param = maingrid.getCudData();
          let isErr = false;

          // 필수체크

          maingrid.gridOptions.api.forEachNode(function (rowNode, index) {
            if (
              isErr == false &&
              (rowNode.data.etype === "C" || rowNode.data.etype === "U")
            ) {
              rowNode.setSelected(true);
              let selectedRow = maingrid.gridOptions.api.getSelectedRows();
              maingrid.bindToForm(selectedRow[0]); // grid api 호출
              if (!$("#detailForm").valid()) isErr = true;
            }
          });

          if (isErr == true) return;

          if (!confirm("저장하시겠습니까?")) return;
          $("#btn-save").attr("disabled", true);
          pine.ajax({
            url: "/api/hplmm/sytm/sytm_020/SAVE_D1",
            params: param,
            success: function () {
              alert("처리완료하였습니다.");
              $("#btn-save").attr("disabled", false);
              //재조회
              fn_search();
            },
            error: function () {
              $("#btn-save").attr("disabled", false);
            },
          });
        });

        /* 초기화 */
        function fn_reset() {
          let setVal = {
            BUKRS: $("#session_BUKRS").val(), //회사
            WERKS: "",
            NAME1: "",
          };

          pine.form_setValues("#searchForm", setVal);
        }

        // 초기화
        fn_reset();

        //조회
        fn_search();
      });


    </script>
  </body>
</html>
